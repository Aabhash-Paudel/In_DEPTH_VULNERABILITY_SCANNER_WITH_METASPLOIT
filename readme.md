# In-depth Vulnerability Scanner with Metasploit  

This is a custom network vulnerability scanner that integrates Nmap and Metasploit for comprehensive network scanning and vulnerability assessment.

## Prerequisites

Before running the script, ensure you have the following set up:

1. **Python 3**: The script is written in Python 3.
2. **Nmap** installed and accessible from the command line
3. **Metasploit_Framework** installed and configured
4. **Required Python modules**: Install the following Python modules:
   - nmap
   - requests
   - pymetasploit3
   - colorama
   - art

You can install the required Python libraries using pip: ( use root if not working)

pip install python-nmap requests pymetasploit3 colorama art

## Configuration

1. Set up Metasploit RPC:
   - Start the Metasploit RPC server using root:
   
> 	sudo msfconsole
   	
>    msfrpcd -P your_password -S -a 127.0.0.1
     

##    default : 
     
>    msfrpcd -P aashu22 -S -a 127.0.0.1  
     
   - Update the `MSF_PASSWD` variable in the script(Vuln_scanner.py) with your Metasploit RPC password if you change it.
   
Note: The password and port should match those in the script (MSF_PASSWD and port in GLOBAL_C initialization in the script).

2. Ensure you have appropriate permissions to run Nmap scans and access the specified log file location (`/var/log/custom_nmap_metasploit.log`).

##check if your msf is working or not:
  
> msfrpcd -P your_password -S


## Script Overview

This script performs the following main functions:

1. Connects to the Metasploit RPC server.
2. Initializes the Metasploit console and checks the database connection.
3. Reads a list of IP addresses and Metasploit modules from input files.
4. Performs vulnerability checks using the specified Metasploit modules.
5. For SMB-related scans, it uses Nmap to gather additional information.
6. Logs the results and writes the findings to an output file.


## Usage

For ip adresses on your network, you can run NMAP_ip_scanner.sh

> bash Nmap_ip_scanner.sh or ./NMAP_ip_scanner.sh

Note: You can also manually enter ip_address of the device you want to scan. (DONOT LEAVE EMPTY LINES)

Run the script with the following command: (Requires root privilege)

> sudo python3 Vuln_scanner.py -i <input_file> -l <module_file> -o <output_file> [-v]

Arguments:
- `-i`: Input file containing subnets or IPs to scan (one per line)
- `-l`: CSV file containing Metasploit module details
- `-o`: Output file to store scan results
- `-v`: (Optional) Enable verbose output

## Input Files

1. Target file (`-i`): 
   - Text file with one IP address or subnet per line 
   (Dont leave any empty lines, it might cause 'Out of index' error)

2. Module file (`-l`):
   - CSV file with the following columns:
     - Port number
     - Metasploit module path
     - Vulnerability name

Example module file content:

port,module,vulnerability
445,auxiliary/scanner/smb/smb_ms17_010,EternalBlue

## Output

The script will generate a detailed output file containing:
- Open ports for each target
- SMB information (if available)
- Detected vulnerabilities and their details

## Notes

- Ensure you have the legal right and permission to scan the target networks.
- The script requires root/administrator privileges to perform full port scans.
- Scanning can be time-consuming, especially for large networks or numerous targets.
- Adjust the timeout settings in the script if needed for your network environment.

## Troubleshooting

- If you encounter database connection issues, ensure the Metasploit database is properly set up and connected.
- For any "module not found" errors, verify that all required Python libraries are installed and up to date.
- Check the log file (`/var/log/custom_nmap_metasploit.log`) for detailed error messages and debugging information.

## Disclaimer

This tool is for educational and authorized testing purposes only. Ensure you have explicit permission to scan any networks or systems. I(Author) am not responsible for any misuse or damage caused by this tool.

Happy hacking!!
- Aabhash Paudel
- 22781A3746
- itsmeavron@gmail.com
- Iamme00
